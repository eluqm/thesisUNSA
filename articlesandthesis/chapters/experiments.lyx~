#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass extbook
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
En este capítulo, serán presentados los resultados que fueron alcanzados
 en las tareas de generación y predicción de escenarios hidrólogicos.
 La sección 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Usando-Bases-Ortonormales"

\end_inset

 describe el análisis 
\lang spanish-mexico
de conectividad y su impacto en el desempeño de las Redes 
\emph on
Echo State
\emph default
 utilizando series de tiempo hidrológicas, las demas secciones, describen
 los resultados obtenidos por nuestro modelo.
 
\end_layout

\begin_layout Section

\lang spanish-mexico
Usando Bases Ortonormales como pesos
\begin_inset CommandInset label
LatexCommand label
name "sec:Usando-Bases-Ortonormales"

\end_inset


\end_layout

\begin_layout Standard

\lang spanish-mexico
Trabajos como los de 
\begin_inset CommandInset citation
LatexCommand cite
key "Millea2014"

\end_inset

 y 
\begin_inset CommandInset citation
LatexCommand citet
key "Koryakin201235"

\end_inset

 proponen que los pesos de una RNN
\emph on
-echo
\emph default
 funcionan como una clase de base dinámica para la señal original descomponiendo
la en subcomponentes, utilizando una base que maximiza la diferencia entre
 ellos
\lang english
, esto basado en un enfoque que tiene su base teórica en el campo conocido
 como 
\emph on
Compressed Sensing
\emph default
\lang spanish-mexico

\begin_inset CommandInset citation
LatexCommand citep
key "Candes"

\end_inset

.
 Por lo tanto, una base ortonormal como la matriz de pesos podría dar mejores
 resultados que usar una simple matriz esparsa de pesos aleatorios.
 
\end_layout

\begin_layout Standard
A pesar de que los experimentos realizados por 
\lang spanish-mexico

\begin_inset CommandInset citation
LatexCommand citet
key "Koryakin201235"

\end_inset


\lang english
 son de los primeros estudios en la literatura sobre RNN-
\emph on
echo que utilizan bases ortonormales como parámetro de conectividad
\emph default
.
 Esos experimentos no fueron realizados sobre series temporales de tipo
 hidrológicas.
 Bajo esa premisa, en este trabajo se realizaron experimentos con este tipo
 de series temporales(
\lang spanish-mexico
MOPEX 
\begin_inset CommandInset citation
LatexCommand citep
key "Duan20063"

\end_inset


\lang english
).
 Los resultados los veremos acontinuación.
 
\end_layout

\begin_layout Standard
El objetivo en estos experimentos era ver cuál es la diferencia entre una
 matriz de pesos ortonormal y una matriz esparsa de pesos aleatorios en
 el desempeño de la RNN-echo.
 Para eso, se realizó una serie de 16 experimentos sobre los datos 
\lang spanish-mexico
de series hidrológicas temporales
\lang english
, para cada valor de conectividad, que va de 0 a 1 en incrementos de 0,01,
 luego se calculó la probabilidad de que la RNN-echo diera un error, como
 la relación entre el número de veces que ese error (RMSE) fue menor que
 un cierto umbral (como por ejemplo 
\begin_inset Formula $P=8.5\times10^{-1}$
\end_inset

) y las 16 repeticiones realizadas.
 
\end_layout

\begin_layout Standard
En la Figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:orth_vs_sparsa"

\end_inset

 se muestra cómo se distribuyen los valores en la matriz ortonormal en comparaci
ón con la matriz esparsa aleatoria.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/edson/Documents/tesis/thesisUNSA/thesisUNSA/articlesandthesis/figures/orth_vs_sparse.pdf
	lyxscale 25
	scale 25

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:orth_vs_sparsa"

\end_inset

Distribución visual de pesos utilizando matrices esparsa y ortonormal para
 el reservorio de neuronas (fijamos el tamaño a 30 Neuronas) con conectividad
 desde 0.1 hasta 0.9.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
En las Figuras 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Probabilidad-de-orth"

\end_inset

 y 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Probabilidad-de-sparsa"

\end_inset

 se muestra la probabilidad de alcanzar un error menor que 
\begin_inset Formula $P$
\end_inset

 con 
\begin_inset Formula $P=8\times10^{-1},8.5\times10^{-1},9\times10^{-1},9.5\times10^{-1}$
\end_inset

 en función de la conectividad para una matriz ortonormal de pesos y una
 matriz sparsa respectivamente.
\end_layout

\begin_layout Standard
A continuación, realizó una prueba 
\begin_inset Formula $t$
\end_inset

 de dos muestras no emparejadas para comprobar si de hecho la matriz ortonormal
 funciona mejor.
 Se seleccionó como entrada para el t-test las probabilidades para 
\begin_inset Formula $P=8\times10^{-1},8.5\times10^{-1},9\times10^{-1},9.5\times10^{-1}$
\end_inset

 de una matriz ortonormal (primera muestra) y para la matriz esparsa aleatoria
 con el radio espectral establecido en 0.9 y tamaño de reservorio de 30 unidades
 (para la segunda muestra).
 
\end_layout

\begin_layout Standard
Donde:
\end_layout

\begin_layout Itemize
La hipótesis nula: las dos muestras provienen de distribuciones con igual
 media (ver Tabla 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:t-test"

\end_inset

).
\end_layout

\begin_layout Itemize
El intervalo de confianza: 
\begin_inset Formula $100\times\left(1-\alpha\right)$
\end_inset

.
\end_layout

\begin_layout Itemize
Nivel de significancia: 
\begin_inset Formula $\alpha=0.05$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/edson/Documents/tesis/thesisUNSA/thesisUNSA/articlesandthesis/figures/orth_prob_plot.pdf
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Probabilidad-de-orth"

\end_inset

Probabilidad de encontrar una red RNN-echo con un NRMSE 
\begin_inset Formula $<P$
\end_inset

 cuando se utiliza una matriz de peso ortonormal para series de tiempo hidrológi
cas, en función de la conectividad y el tamaño de su reservorio.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Vemos que los 
\begin_inset Formula $P$
\end_inset

 para el cual la hipótesis nula puede ser rechazada al nivel de significancia
 del 
\begin_inset Formula $5\%$
\end_inset

 son 
\begin_inset Formula $P=8.5\times10^{-1},9\times10^{-1},9.5\times10^{-1}$
\end_inset

.
 Así que la diferencia de rendimiento entre una matriz ortonormal y una
 matriz esparsa aleatoria con radio espectral 
\begin_inset Formula $=0.9$
\end_inset

 es significativa en esos valores de 
\begin_inset Formula $P$
\end_inset

.
 Por lo tanto, el uso de matrices ortonormales en series de características
 hidrológicas no presenta mejoras en el rendimiento de las redes RNN-echo,
 basado en lo anterior decidimos utilizar una topología de matriz esparsa
 aleatoria para nuestros siguientes experimentos.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
P=probabilidad
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p$
\end_inset

-value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Intervalo de confidencia 
\begin_inset Formula $IC$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0972$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left[-0.0006;0.0067\right]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.5\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3.0316e-126$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left[0.8271;0.8720\right]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.8810e-91$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left[0.6247;0.6839\right]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9.5\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.1528e-51$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left[0.2387;0.2844\right]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:t-test"

\end_inset

Resultados de prueba 
\begin_inset Formula $t$
\end_inset

 de dos muestras no emparejadas, se compara la probabilidad de obtener un
 error menor que 
\begin_inset Formula $P$
\end_inset

 usando una matriz ortogonal y matriz esparsa aleatoria como topología del
 reservorio de una RNN-echo.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Vemos que la conectividad es crítica para encontrar una buena RNN-echo para
 predecir con mayor precisión valores futuros.
 En contraste con resultados previos como los de 
\lang spanish-mexico

\begin_inset CommandInset citation
LatexCommand cite
key "Millea2014"

\end_inset

 y 
\begin_inset CommandInset citation
LatexCommand citet
key "Koryakin201235"

\end_inset


\lang english
, no se detectó que una topologia de matriz ortonormal tenga mejor o igual
 desempeño, que una de matriz aleatoria.
 Cuando usamos matrices de peso ortonormal (y una función de activación
 lineal), no necesitamos establecer el radio espectral, no necesitamos escalar
 los pesos de la matriz, ni siquiera los pesos de entrada.
 Simplemente establecimos el vector de entrada y generamos una matriz ortonormal
 con pesos de una distribución uniforme entre 0 y 1.
 Para ello utilizamos la función 
\emph on
orth
\emph default
 de 
\emph on
Matlab
\emph default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/edson/Documents/tesis/thesisUNSA/thesisUNSA/articlesandthesis/figures/esparse_prob_plot.pdf
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Probabilidad-de-sparsa"

\end_inset

Probabilidad de encontrar una red RNN-echo con un NRMSE 
\begin_inset Formula $<P$
\end_inset

 cuando se utiliza una matriz de peso esparsa aleatoria para series de tiempo
 hidrológicas, en función de la conectividad y el tamaño de su reservorio.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Performing extensive experiments with echo state networks, we had an intuition
 that the weights of the network function as a kind of dynamical basis for
 our original signal.
 Decomposing the signal into pertinent sub-components, by using a basis
 which maximizes the difference between them, like for example an orthonormal
 basis as the weight matrix, might give better results than just a simple
 random weight matrix.
 And it turned out it is indeed so.
 When using orthonormal weight matrices (and a linear activation function,
 as we do), we don’t need to set the spectral radius, we don’t need to scale
 the matrix weights, or even the input weights (in most cases).
 We just set the input vector to ones (we did this for simplicity, however
 any random input vector can be used to give almost the same results) and
 get an orthonormal matrix out of a random weight matrix with weights from
 an uniform distribution between 0 and 1.
 For this we used the orth function from the Matlab software package.
 We show in Figure
\end_layout

\end_body
\end_document
